{% extends "base.html" %}

{% block title %}{{ warehouse.name }} - Warehouse Details{% endblock %}

{% block content %}
<div class="nav">
    <a href="{{ url_for('index') }}">&larr; Back to Warehouses</a>
</div>

<h1>{{ warehouse.name }}</h1>

{% if error %}
<div class="error">{{ error }}</div>
{% endif %}

<div class="warehouse-item status-card">
    <h3>ğŸ“¦ Status</h3>
    <div class="status-grid">
        <div class="status-stat">
            <span class="stat-value">{{ warehouse.varasto.tilavuus }}</span>
            <span class="stat-label">Capacity</span>
        </div>
        <div class="status-stat">
            <span class="stat-value">{{ warehouse.varasto.saldo }}</span>
            <span class="stat-label">Balance</span>
        </div>
        <div class="status-stat">
            <span class="stat-value">{{ warehouse.varasto.paljonko_mahtuu() }}</span>
            <span class="stat-label">Available</span>
        </div>
    </div>

    {% if warehouse.varasto.tilavuus > 0 %}
    <div class="progress-bar animated-bar">
        {% set fill = (warehouse.varasto.saldo / warehouse.varasto.tilavuus) * 100 %}
        <div class="progress-fill" style="width: {{ fill }}%"></div>
    </div>
    <p class="fill-text">{{ "%.1f"|format(fill) }}% full</p>
    {% endif %}
</div>

<div class="warehouse-item action-card">
    <h3>âš¡ Quick Actions</h3>
    <div class="quick-actions">
        <form action="{{ url_for('add_to_warehouse', warehouse_id=warehouse_id) }}" method="post" class="action-form" id="addForm">
            <div class="action-group add-group">
                <button type="button" class="action-btn add-btn" onclick="adjustAmount('add', -1)">âˆ’</button>
                <input type="number" name="maara" id="addAmount" min="0" step="0.1" value="1" class="action-input" required>
                <button type="button" class="action-btn add-btn" onclick="adjustAmount('add', 1)">+</button>
                <button type="submit" class="btn btn-success action-submit pulse-on-hover">
                    <span class="btn-icon">ğŸ“¥</span> Add
                </button>
            </div>
        </form>
        
        <form action="{{ url_for('remove_from_warehouse', warehouse_id=warehouse_id) }}" method="post" class="action-form" id="removeForm">
            <div class="action-group remove-group">
                <button type="button" class="action-btn remove-btn" onclick="adjustAmount('remove', -1)">âˆ’</button>
                <input type="number" name="maara" id="removeAmount" min="0" step="0.1" value="1" class="action-input" required>
                <button type="button" class="action-btn remove-btn" onclick="adjustAmount('remove', 1)">+</button>
                <button type="submit" class="btn btn-danger action-submit pulse-on-hover">
                    <span class="btn-icon">ğŸ“¤</span> Remove
                </button>
            </div>
        </form>
    </div>
    
    <div class="preset-buttons">
        <span class="preset-label">Quick add:</span>
        <button type="button" class="preset-btn bounce" onclick="quickAction('add', 5)">+5</button>
        <button type="button" class="preset-btn bounce" onclick="quickAction('add', 10)">+10</button>
        <button type="button" class="preset-btn bounce" onclick="quickAction('add', 25)">+25</button>
        <span class="preset-divider">|</span>
        <span class="preset-label">Quick remove:</span>
        <button type="button" class="preset-btn bounce" onclick="quickAction('remove', 5)">âˆ’5</button>
        <button type="button" class="preset-btn bounce" onclick="quickAction('remove', 10)">âˆ’10</button>
        <button type="button" class="preset-btn bounce" onclick="quickAction('remove', 25)">âˆ’25</button>
    </div>
</div>

<div class="warehouse-item manage-card">
    <h3>âš™ï¸ Manage Warehouse</h3>
    <div class="manage-buttons">
        <a href="{{ url_for('edit_warehouse', warehouse_id=warehouse_id) }}" class="btn btn-secondary pulse-on-hover">âœï¸ Edit</a>
        <form action="{{ url_for('delete_warehouse', warehouse_id=warehouse_id) }}" method="post" class="inline-form" onsubmit="return confirm('Are you sure you want to delete this warehouse?');">
            <button type="submit" class="btn btn-danger pulse-on-hover">ğŸ—‘ï¸ Delete</button>
        </form>
    </div>
</div>

<script>
function adjustAmount(type, delta) {
    const input = document.getElementById(type === 'add' ? 'addAmount' : 'removeAmount');
    let value = parseFloat(input.value) || 0;
    value = Math.max(0, value + delta);
    input.value = value;
    input.classList.add('pop');
    setTimeout(() => input.classList.remove('pop'), 150);
}

function quickAction(type, amount) {
    const input = document.getElementById(type === 'add' ? 'addAmount' : 'removeAmount');
    input.value = amount;
    input.classList.add('pop');
    setTimeout(() => {
        input.classList.remove('pop');
        document.getElementById(type + 'Form').submit();
    }, 200);
}
</script>
{% endblock %}
